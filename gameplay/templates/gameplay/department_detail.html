{% extends 'gameplay/base.html' %}

{% block content %}
    <a href="{% url 'departments_page' %}">← Back to Leaderboard</a>

    <div class="card" style="margin-top: 20px; border-top: 5px solid #e67e22;">
        <h1>{{ department.name }}</h1>
        <p style="font-size: 1.2em; color: #555;">{{ department.description }}</p>
        
        {% if video_embed_url %}
            <div style="margin: 20px 0;">
                <h3>Meet the Team</h3>
                <iframe 
                    width="100%" 
                    height="450" 
                    src="{{ video_embed_url }}" 
                    title="YouTube video player" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
                </iframe>
            </div>
        {% endif %}

        <hr>
        
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h3>Team Score: {{ total_score }} points</h3>
            </div>
            
            <div>
                {% if request.user.is_superuser %}
                    <a href="{% url 'add_department_question' department.id %}">
                        <button style="background: #f39c12; color: white; border: none; padding: 10px; border-radius: 5px;">
                            ✏️ Manage Quiz
                        </button>
                    </a>
                {% endif %}

                {% if not has_taken_quiz and questions.exists %}
                    <a href="{% url 'take_department_quiz' department.id %}">
                        <button style="background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 5px; font-size: 1.1em;">
                            Take Onboarding Quiz
                        </button>
                    </a>
                {% elif has_taken_quiz %}
                    <button disabled style="background: #ccc; border: none; padding: 10px 20px; border-radius: 5px;">
                        Quiz Completed
                    </button>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}